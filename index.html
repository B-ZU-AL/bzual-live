<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pixel Error Lab 2000</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Share+Tech+Mono&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app-shell">
      <section class="winamp-frame">
        <header class="topbar">
          <span class="topbar-brand topbar-brand-left" data-i18n="brand_left">PIXEL ERROR LAB 2000</span>
          <div class="topbar-right">
            <span class="topbar-brand topbar-brand-right" data-i18n="brand_right">B.ZU.AL Studios</span>
            <button id="infoLegalBtn" class="btn mini top-info-btn" data-i18n="info_btn">Info</button>
            <button id="learnBtn" class="btn mini top-info-btn learn-btn">
              <span class="learn-btn-icon" aria-hidden="true">?</span>
              <span data-i18n="learn_btn">Aprender</span>
            </button>
            <label class="lang-picker">
              <span data-i18n="language">Language</span>
              <select id="languageSelect">
                <option value="es">ES</option>
                <option value="en">EN</option>
              </select>
            </label>
          </div>
        </header>

        <div class="main-layout">
          <aside class="left-panel">
            <nav class="workflow-tabs" aria-label="Workspace">
              <button class="btn workflow-tab" data-panel="setup" id="tabSetup" data-i18n="tab_setup">Setup</button>
              <button class="btn workflow-tab active" data-panel="live" id="tabLive" data-i18n="tab_live">Live</button>
              <button class="btn workflow-tab" data-panel="studio" id="tabStudio" data-i18n="tab_studio">Studio</button>
            </nav>

            <section class="workspace-panel" id="panelSetup" hidden>
              <h2 class="panel-title" data-i18n="setup_title">Input + Routing</h2>
              <div class="control input-entry-row">
                <label class="input-entry" for="imageInput">
                  <span class="input-entry-icon">IMG</span>
                  <span class="input-entry-label" data-i18n="load_image">Load Image</span>
                  <input type="file" id="imageInput" accept="image/*" />
                </label>
                <button id="webcamBtn" class="input-entry input-entry-btn" data-i18n="enable_webcam">
                  Enable Webcam
                  <span class="input-entry-icon">CAM</span>
                </button>
              </div>
              <p class="status-line" id="inputSpecs">Input: none</p>
              <p class="status-line setup-active-input" id="quickInputActiveText">Entrada activa: Ninguna</p>
              <div id="webcamSetupControls" class="canvas-format-row setup-webcam-controls" hidden>
                <label class="inline-select">
                  <span data-i18n="webcam_framing">Webcam Framing</span>
                  <select id="webcamFramingSelect">
                    <option value="cover" selected data-i18n="framing_cover">Cover</option>
                    <option value="smart" data-i18n="framing_smart">Smart Fill</option>
                    <option value="contain" data-i18n="framing_contain">Contain</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="render_quality">Render Quality</span>
                  <select id="canvasRenderQualitySelect">
                    <option value="auto" selected data-i18n="quality_auto">Auto</option>
                    <option value="high" data-i18n="quality_high">High</option>
                    <option value="ultra" data-i18n="quality_ultra">Ultra</option>
                  </select>
                </label>
              </div>
              <div class="control">
                <label class="inline-select">
                  <span data-i18n="camera_device">Camera Device</span>
                  <select id="cameraDeviceSelect"></select>
                </label>
                <button id="refreshCamsBtn" class="btn mini" data-i18n="refresh_cameras">Refresh Cameras</button>
              </div>
              <div class="control">
                <label class="inline-select">
                  <span data-i18n="theme_mode">Tema de interfaz</span>
                  <select id="themeModeSelect">
                    <option value="light" data-i18n="theme_light">Claro</option>
                    <option value="dark" data-i18n="theme_dark" selected>Oscuro</option>
                  </select>
                </label>
              </div>

              <div class="mode-box" role="radiogroup" aria-label="Mode">
                <label><input type="radio" name="mode" value="none" checked /> <span data-i18n="mode_clean">Clean</span></label>
                <label><input type="radio" name="mode" value="glitch" /> <span data-i18n="mode_glitch">Glitch</span></label>
                <label><input type="radio" name="mode" value="fractal" /> <span data-i18n="mode_fractal">Fractal</span></label>
                <label><input type="radio" name="mode" value="depth" /> <span data-i18n="mode_depth">3D Stage</span></label>
                <label><input type="radio" name="mode" value="particles" /> <span data-i18n="mode_particles">Particles</span></label>
                <label><input type="radio" name="mode" value="lines" /> <span>Lines</span></label>
                <label><input type="radio" name="mode" value="tunnel" /> <span>Tunnel</span></label>
                <label><input type="radio" name="mode" value="interior" /> <span>Interior</span></label>
              </div>

              <div class="control preset-control">
                <label for="presetSelect" data-i18n="preset">Preset</label>
                <select id="presetSelect"></select>
              </div>

              <div class="group setup-audio">
                <h2 data-i18n="audio_reactive">Audio Reactive</h2>
                <button id="micBtn" class="btn" data-i18n="enable_mic">Enable Mic</button>
                <label class="input-entry" for="audioFileInput">
                  <span class="input-entry-icon">AUD</span>
                  <span class="input-entry-label" data-i18n="load_audio">Load Audio</span>
                  <input type="file" id="audioFileInput" accept="audio/*" />
                </label>
                <div id="audioFilePlayerWrap" class="audio-file-player" hidden>
                  <audio id="audioFilePlayer" controls preload="metadata"></audio>
                  <button id="audioFileClearBtn" class="btn mini" data-i18n="clear_audio">Clear Audio</button>
                </div>
                <label class="inline-select">
                  <span data-i18n="audio_input">Audio Input</span>
                  <select id="audioInputSource">
                    <option value="mic" data-i18n="audio_input_mic">Microphone</option>
                    <option value="file" data-i18n="audio_input_file">Audio File</option>
                    <option value="system" data-i18n="audio_input_system">System / Device Audio</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="audio_target">Target</span>
                  <select id="audioTarget">
                    <option value="points" data-i18n="audio_target_points">Points</option>
                    <option value="mesh" data-i18n="audio_target_mesh">Mesh</option>
                    <option value="all" data-i18n="audio_target_both" selected>All modules</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="audio_animation">Animation</span>
                  <select id="audioAnimation">
                    <option value="lift" data-i18n="audio_anim_lift">Lift</option>
                    <option value="wave" data-i18n="audio_anim_wave">Wave</option>
                    <option value="color" data-i18n="audio_anim_color">Color</option>
                    <option value="all" data-i18n="audio_anim_all">All</option>
                  </select>
                </label>
                <label class="slider">
                  <span data-i18n="audio_sensitivity">Audio Sensitivity</span>
                  <input type="range" id="audioSensitivity" min="0" max="120" value="52" />
                  <output for="audioSensitivity">52</output>
                </label>
                <label class="slider">
                  <span data-i18n="audio_tolerance">Audio Tolerance</span>
                  <input type="range" id="audioTolerance" min="0" max="120" value="32" />
                  <output for="audioTolerance">32</output>
                </label>
                <label class="slider">
                  <span data-i18n="audio_points_intensity">Points Audio Intensity</span>
                  <input type="range" id="audioPointsIntensity" min="0" max="200" value="120" />
                  <output for="audioPointsIntensity">120</output>
                </label>
                <label class="slider">
                  <span data-i18n="audio_mesh_intensity">Mesh Audio Intensity</span>
                  <input type="range" id="audioMeshIntensity" min="0" max="200" value="120" />
                  <output for="audioMeshIntensity">120</output>
                </label>
                <label class="slider">
                  <span data-i18n="audio_anim_variation">Audio Animation Variation</span>
                  <input type="range" id="audioAnimVariation" min="0" max="200" value="100" />
                  <output for="audioAnimVariation">100</output>
                </label>
                <p class="info-tip" id="audioHelpText" data-i18n="audio_help">
                  System audio uses screen/tab sharing on browsers. Enable "Share audio" in the picker.
                </p>
                <p class="status-line" id="audioRouteStatus" data-i18n="audio_status_idle">Audio: idle</p>
              </div>
            </section>

            <section class="workspace-panel active" id="panelLive">
              <h2 class="panel-title" data-i18n="live_title">Performance Rack</h2>
              <div class="group live-audio-rack">
                <h2 data-i18n="live_audio_quick">Audio Quick Start</h2>
                <div class="live-audio-actions">
                  <button id="liveAudioStartBtn" class="btn btn-audio-react">
                    <span class="action-icon action-icon-wave">AUD</span>
                    <span class="action-label" data-i18n="audio_input">Entrada de audio</span>
                    <span class="audio-live-dot" aria-hidden="true"></span>
                  </button>
                  <button id="liveAudioPauseBtn" class="btn btn-audio-load">
                    <span class="action-icon action-icon-folder">LOAD</span>
                    <span class="action-label" data-i18n="load_audio">Cargar audio</span>
                  </button>
                </div>
                <label class="inline-select" id="liveAudioInputPicker" hidden>
                  <span data-i18n="audio_input">Audio Input</span>
                  <select id="liveAudioInputQuick">
                    <option value="mic" data-i18n="audio_input_mic">Microphone</option>
                    <option value="file" data-i18n="audio_input_file">Audio File</option>
                    <option value="system" data-i18n="audio_input_system">System / Device Audio</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="audio_target">Target</span>
                  <select id="liveAudioTargetQuick">
                    <option value="points" data-i18n="audio_target_points">Points</option>
                    <option value="mesh" data-i18n="audio_target_mesh">Mesh</option>
                    <option value="all" data-i18n="audio_target_both">All modules</option>
                  </select>
                </label>
                <label class="slider">
                  <span data-i18n="audio_sensitivity">Audio Sensitivity</span>
                  <input type="range" id="liveAudioSensitivityQuick" min="0" max="120" value="52" />
                  <output for="liveAudioSensitivityQuick">52</output>
                </label>
                <label class="slider">
                  <span data-i18n="audio_tolerance">Audio Tolerance</span>
                  <input type="range" id="liveAudioToleranceQuick" min="0" max="120" value="32" />
                  <output for="liveAudioToleranceQuick">32</output>
                </label>
                <div class="pad-label"><span class="pad-icon">AUD</span><span>Audio Pad (X=Sensitivity / Y=Tolerance)</span></div>
                <div id="liveAudioPad" class="depth-pad live-fx-pad audio-pad">
                  <canvas id="liveAudioPadScope" class="audio-pad-scope" width="420" height="104" aria-label="Audio pad scope"></canvas>
                  <div class="audio-pad-wave"></div>
                  <div id="liveAudioPadDot" class="depth-pad-dot"></div>
                </div>
                <div id="liveAudioFileMini" class="live-audio-file-mini" hidden>
                  <div class="live-audio-file-title">
                    <span data-i18n="now_playing">Now Playing</span>
                    <span id="liveAudioFileName" class="live-audio-file-name" data-text="">-</span>
                  </div>
                  <div id="liveAudioFileControls" class="live-audio-file-controls">
                    <button id="liveAudioPlayPauseBtn" class="btn mini live-audio-play-btn" data-i18n="play">Play</button>
                    <input type="range" id="liveAudioSeek" min="0" max="1000" value="0" />
                    <span id="liveAudioTime">00:00 / 00:00</span>
                    <button id="liveAudioClearBtn" class="btn mini" data-i18n="clear_audio">Clear Audio</button>
                  </div>
                  <canvas id="liveAudioWaveform" class="live-audio-waveform" width="520" height="36" aria-label="Audio waveform mini"></canvas>
                </div>
                <p class="status-line" id="liveAudioStatusQuick">Audio: idle</p>
              </div>
              <div class="live-mode-readout-wrap">
                <div class="live-input-row">
                  <label class="live-input-box live-input-source" for="quickInputSelect">
                    <span class="live-input-box-label">Entrada activa</span>
                    <select id="quickInputSelect" class="live-input-select">
                      <option value="image">Imagen</option>
                      <option value="webcam">Webcam</option>
                      <option value="noinput">Sin input</option>
                      <option value="clear">Quitar</option>
                    </select>
                  </label>
                </div>
                <div class="live-filter-readout-box">
                  <p class="live-mode-readout-label" data-i18n="active_filter">Filtro activo</p>
                  <div id="liveModeReadout" class="live-mode-readout" role="status" aria-live="polite">
                    <span id="liveModeReadoutText" class="live-mode-readout-text">[ GLITCH // LIVE ]</span>
                  </div>
                </div>
              </div>
              <div id="livePaneGlitch" class="group live-pane">
                <h2>Glitch Essentials</h2>
                <label class="slider"><span>Intensity</span><input type="range" id="liveGlitchIntensity" min="0" max="100" value="0" /><output for="liveGlitchIntensity">0</output></label>
                <label class="slider"><span>Color Mix</span><input type="range" id="liveGlitchColor" min="0" max="100" value="50" /><output for="liveGlitchColor">50</output></label>
                <label class="slider"><span>Error Complexity</span><input type="range" id="liveGlitchError" min="0" max="100" value="0" /><output for="liveGlitchError">0</output></label>
                <label class="slider"><span>Tracking FX</span><input type="range" id="liveGlitchTracking" min="0" max="100" value="0" /><output for="liveGlitchTracking">0</output></label>
                <label class="slider"><span>Motion Trail</span><input type="range" id="liveGlitchTrail" min="0" max="100" value="0" /><output for="liveGlitchTrail">0</output></label>
                <label class="slider"><span>Anim Distort</span><input type="range" id="liveGlitchAnim" min="0" max="100" value="0" /><output for="liveGlitchAnim">0</output></label>
                <div id="liveGlitchPadLabel" class="pad-label"><span class="pad-icon">GL</span><span>Glitch Pad (X=Intensity / Y=Color)</span></div>
                <div id="liveGlitchPad" class="depth-pad live-fx-pad">
                  <div id="liveGlitchPadDot" class="depth-pad-dot"></div>
                </div>
                <div id="liveGlitchPadBLabel" class="pad-label"><span class="pad-icon">FX2</span><span>Glitch Pad B (X=Error / Y=Tracking)</span></div>
                <div id="liveGlitchPadB" class="depth-pad live-fx-pad">
                  <div id="liveGlitchPadBDot" class="depth-pad-dot"></div>
                </div>
                <div id="liveGlitchPadCLabel" class="pad-label"><span class="pad-icon">FX3</span><span>Glitch Pad C (X=Trail / Y=Anim Distort)</span></div>
                <div id="liveGlitchPadC" class="depth-pad live-fx-pad">
                  <div id="liveGlitchPadCDot" class="depth-pad-dot"></div>
                </div>
                <p class="micro-tip">Tip: webcam + tracking FX da glitch facial/manos en tiempo real.</p>
              </div>
              <div id="livePaneFractal" class="group live-pane" hidden>
                <h2>Fractal Essentials</h2>
                <label class="inline-select">
                  <span>Preset</span>
                  <select id="liveFractalPreset">
                    <option value="sacred">Sacred Bloom</option>
                    <option value="ether">Ether Orbit</option>
                    <option value="inside">Inside 360</option>
                    <option value="flat">Flat Illustration</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Quality</span>
                  <select id="liveFractalQuality">
                    <option value="low">Low</option>
                    <option value="med" selected>Med</option>
                    <option value="high">High</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Behavior</span>
                  <select id="liveFractalBehavior">
                    <option value="stable" selected>Stable</option>
                    <option value="performance">Performance</option>
                    <option value="aggressive">Aggressive</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Audio Motion</span>
                  <select id="liveFractalAudioMode">
                    <option value="balanced" selected>Balanced</option>
                    <option value="bass">Bass Pulse</option>
                    <option value="spectral">Spectral Flow</option>
                    <option value="rhythmic">Rhythmic</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Fractal Camera</span>
                  <select id="liveFractalCameraMode">
                    <option value="orbit">Orbit Planet</option>
                    <option value="inside">Center 360</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Fractal Dome</span>
                  <select id="liveFractalDomeMode">
                    <option value="off" selected>Off</option>
                    <option value="dome-standard">Dome Standard</option>
                    <option value="dome-equirect">Dome Equirect</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Fractal Variant</span>
                  <select id="liveFractalVariant">
                    <option value="a" selected>Variant A</option>
                    <option value="b">Variant B</option>
                  </select>
                </label>
                <label class="slider"><span>Camera Speed</span><input type="range" id="liveFractalCamSpeed" min="0" max="100" value="0" /><output for="liveFractalCamSpeed">0</output></label>
                <label class="slider"><span>Camera Distance</span><input type="range" id="liveFractalDistance" min="20" max="180" value="76" /><output for="liveFractalDistance">76</output></label>
                <label class="inline-select">
                  <span>Math Shape</span>
                  <select id="liveFractalShapeB">
                    <option value="mandel" selected>Mandelbulb</option>
                  </select>
                </label>
                <label class="slider"><span>Shape Morph</span><input type="range" id="liveFractalShapeMorph" min="0" max="100" value="0" /><output for="liveFractalShapeMorph">0</output></label>
                <label class="slider"><span>Symmetry</span><input type="range" id="liveFractalSymmetry" min="8" max="24" value="14" step="1" /><output for="liveFractalSymmetry">14</output></label>
                <label class="slider"><span>Fractal Power</span><input type="range" id="liveFractalPower" min="60" max="120" value="84" /><output for="liveFractalPower">84</output></label>
                <label class="slider"><span>Fog Density</span><input type="range" id="liveFractalFog" min="0" max="80" value="24" /><output for="liveFractalFog">24</output></label>
                <label class="slider"><span>Glow</span><input type="range" id="liveFractalGlow" min="0" max="100" value="52" /><output for="liveFractalGlow">52</output></label>
                <label class="slider"><span>Light Intensity</span><input type="range" id="liveFractalLight" min="20" max="300" value="120" /><output for="liveFractalLight">120</output></label>
                <label class="slider"><span>Spin</span><input type="range" id="liveFractalSpin" min="0" max="100" value="0" /><output for="liveFractalSpin">0</output></label>
                <label class="slider"><span>Breath</span><input type="range" id="liveFractalBreath" min="0" max="100" value="0" /><output for="liveFractalBreath">0</output></label>
                <label class="slider"><span>Flow Smooth</span><input type="range" id="liveFractalFlow" min="0" max="100" value="62" /><output for="liveFractalFlow">62</output></label>
                <label class="slider"><span>Color Warmth</span><input type="range" id="liveFractalWarmth" min="0" max="100" value="66" /><output for="liveFractalWarmth">66</output></label>
                <label class="inline-select">
                  <span>Fractal Texture</span>
                  <select id="liveFractalTexture">
                    <option value="smooth">Smooth</option>
                    <option value="crystal">Crystal</option>
                    <option value="ink">Ink Lines</option>
                    <option value="contour" selected>Contour</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Texture Layer 2</span>
                  <select id="liveFractalTexture2">
                    <option value="none">None</option>
                    <option value="noise" selected>Noise Veil</option>
                    <option value="ripples">Ripples</option>
                    <option value="cells">Cellular</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Texture Blend</span>
                  <select id="liveFractalTextureBlend">
                    <option value="add">Add</option>
                    <option value="screen" selected>Screen</option>
                    <option value="multiply">Multiply</option>
                    <option value="difference">Difference</option>
                  </select>
                </label>
                <label class="toggle"><input type="checkbox" id="liveFractalOverlayLock" checked /><span>Lock Overlay on Random</span></label>
                <label class="slider"><span>Texture Layer Mix</span><input type="range" id="liveFractalTextureMix" min="0" max="100" value="62" /><output for="liveFractalTextureMix">62</output></label>
                <label class="inline-select">
                  <span>Palette</span>
                  <select id="liveFractalPalette">
                    <option value="warm">Warm Sacred</option>
                    <option value="neon">Neon</option>
                    <option value="cosmic" selected>Cosmic</option>
                    <option value="mono">Mono Ink</option>
                    <option value="input">Input Driven</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Fractal Render</span>
                  <select id="liveFractalRenderMode">
                    <option value="shaded">Shaded</option>
                    <option value="wire">Wire Mesh</option>
                    <option value="points">Point Map</option>
                    <option value="hybrid" selected>Mesh + Points</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Optical Pack</span>
                  <select id="liveFractalOptical">
                    <option value="off" selected>Off</option>
                    <option value="moire">Moire Lines</option>
                    <option value="tunnel">Tunnel Rings</option>
                    <option value="sacred">Sacred Mandala</option>
                    <option value="opart">Op Art Grid</option>
                  </select>
                </label>
                <label class="slider"><span>Optical Amount</span><input type="range" id="liveFractalOpticalAmount" min="0" max="100" value="0" /><output for="liveFractalOpticalAmount">0</output></label>
                <label class="slider"><span>Polygonize</span><input type="range" id="liveFractalPolygonize" min="0" max="100" value="0" /><output for="liveFractalPolygonize">0</output></label>
                <label class="slider"><span>Wire Strength</span><input type="range" id="liveFractalWireStrength" min="0" max="100" value="62" /><output for="liveFractalWireStrength">62</output></label>
                <label class="slider"><span>Point Overlay</span><input type="range" id="liveFractalPointOverlay" min="0" max="100" value="38" /><output for="liveFractalPointOverlay">38</output></label>
                <label class="inline-select">
                  <span>Fractal Style</span>
                  <select id="liveFractalStyle">
                    <option value="lit" selected>Lit</option>
                    <option value="flat">Flat / Illustration</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Fractal Background</span>
                  <select id="liveFractalBackground">
                    <option value="ethereal">Ethereal</option>
                    <option value="sunset">Sunset</option>
                    <option value="cosmic">Cosmic</option>
                    <option value="solid" selected>Solid Flat</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Flat Color</span>
                  <input type="color" id="liveFractalFlatColor" value="#000000" />
                </label>
                <label class="toggle"><input type="checkbox" id="liveFractalAudio" /><span>Use Audio</span></label>
                <label class="slider"><span>Audio Gain</span><input type="range" id="liveFractalAudioGain" min="0" max="200" value="100" /><output for="liveFractalAudioGain">100</output></label>
                <p class="micro-tip">Tip: mandala fractal con respiración lenta + audio bandas suaves.</p>
              </div>
              <div id="livePane3d" class="group live-pane" hidden>
                <h2>3D Essentials</h2>
                <label class="inline-select">
                  <span>Camera Move</span>
                  <select id="liveCameraMode">
                    <option value="static">Static</option>
                    <option value="cursor">Cursor</option>
                    <option value="orbit">Orbit</option>
                    <option value="sweep">Sweep</option>
                    <option value="pulse">Dolly Pulse</option>
                    <option value="helix">Helix</option>
                    <option value="drift">Drift</option>
                    <option value="liquid">Liquid</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Render Engine</span>
                  <select id="live3dRenderEngine">
                    <option value="classic">Classic CPU</option>
                    <option value="gpu" selected>GPU Beta</option>
                  </select>
                </label>
                <label class="slider"><span>Points</span><input type="range" id="live3dPoints" min="0" max="100" value="55" /><output for="live3dPoints">55</output></label>
                <label class="slider"><span>Mesh</span><input type="range" id="live3dMesh" min="0" max="100" value="45" /><output for="live3dMesh">45</output></label>
                <label class="slider"><span>Point Opacity</span><input type="range" id="live3dPointOpacity" min="20" max="220" value="100" /><output for="live3dPointOpacity">100</output></label>
                <label class="slider"><span>Mesh Opacity</span><input type="range" id="live3dMeshOpacity" min="20" max="220" value="100" /><output for="live3dMeshOpacity">100</output></label>
                <label class="slider"><span>Depth Distortion</span><input type="range" id="live3dDepthWarp" min="0" max="100" value="0" /><output for="live3dDepthWarp">0</output></label>
                <label class="slider"><span>Point/Mesh Separation</span><input type="range" id="live3dSeparation" min="0" max="100" value="30" /><output for="live3dSeparation">30</output></label>
                <label class="slider"><span>Background Energy</span><input type="range" id="live3dBackground" min="0" max="100" value="35" /><output for="live3dBackground">35</output></label>
                <label class="slider"><span>Organic Interaction</span><input type="range" id="live3dOrganic" min="0" max="100" value="20" /><output for="live3dOrganic">20</output></label>
                <label class="inline-select">
                  <span>Lighting Mode</span>
                  <select id="live3dLightingMode">
                    <option value="lit">Lit</option>
                    <option value="flat">Flat / Illustrated</option>
                  </select>
                </label>
                <label class="slider"><span>Lighting Power</span><input type="range" id="live3dLight" min="0" max="100" value="70" /><output for="live3dLight">70</output></label>
                <label class="slider"><span>Exposure</span><input type="range" id="live3dExposure" min="40" max="220" value="110" /><output for="live3dExposure">110</output></label>
                <label class="slider"><span>Ambient</span><input type="range" id="live3dAmbient" min="0" max="100" value="35" /><output for="live3dAmbient">35</output></label>
                <label class="slider"><span>Light Azimuth</span><input type="range" id="live3dLightAzimuth" min="-180" max="180" value="-40" /><output for="live3dLightAzimuth">-40</output></label>
                <label class="slider"><span>Light Elevation</span><input type="range" id="live3dLightElevation" min="-80" max="80" value="30" /><output for="live3dLightElevation">30</output></label>
                <label class="inline-select">
                  <span>3D FX Filter</span>
                  <select id="live3dFxMode">
                    <option value="none">None</option>
                    <option value="delay">Delay</option>
                    <option value="echo">Visual Echo</option>
                    <option value="colortrail">Trail (Accented)</option>
                    <option value="prism">Prism Drift</option>
                  </select>
                </label>
                <label class="slider"><span>3D FX Amount</span><input type="range" id="live3dFxAmount" min="0" max="100" value="35" /><output for="live3dFxAmount">35</output></label>
                <label class="toggle"><input type="checkbox" id="live3dAudioSync" /><span>Audio Sync Motion</span></label>
                <label class="toggle"><input type="checkbox" id="live3dAnaglyph" /><span>Anaglyph 3D</span></label>
                <label class="slider"><span>Anaglyph Depth</span><input type="range" id="live3dAnaglyphStrength" min="0" max="100" value="34" /><output for="live3dAnaglyphStrength">34</output></label>
                <div id="live3dPointsPadLabel" class="pad-label"><span class="pad-icon">PTS</span><span>Points Pad (X=Amount / Y=Size)</span></div>
                <div id="live3dPointsPad" class="depth-pad live-fx-pad">
                  <div id="live3dPointsPadDot" class="depth-pad-dot"></div>
                </div>
                <div id="live3dMeshPadLabel" class="pad-label"><span class="pad-icon">MSH</span><span>Mesh Pad (X=Amount / Y=Lift)</span></div>
                <div id="live3dMeshPad" class="depth-pad live-fx-pad">
                  <div id="live3dMeshPadDot" class="depth-pad-dot"></div>
                </div>
                <div id="live3dPadBLabel" class="pad-label"><span class="pad-icon">SEP</span><span>Pad B (X=Separation / Y=Background)</span></div>
                <div id="live3dPadB" class="depth-pad live-fx-pad">
                  <div id="live3dPadBDot" class="depth-pad-dot"></div>
                </div>
                <div id="live3dCamPadLabel" class="pad-label"><span class="pad-icon">CAM</span><span>Camera Pad (X=Follow / Y=Zoom)</span></div>
                <div id="live3dCamPad" class="depth-pad live-fx-pad">
                  <div id="live3dCamPadDot" class="depth-pad-dot"></div>
                </div>
                <div id="live3dRotPadLabel" class="pad-label"><span class="pad-icon">ROT</span><span>Rotation Pad (X=Rotate Y / Y=Rotate X)</span></div>
                <div id="live3dRotPad" class="depth-pad live-fx-pad">
                  <div id="live3dRotPadDot" class="depth-pad-dot"></div>
                </div>
                <div id="live3dColorPadLabel" class="pad-label"><span class="pad-icon">CLR</span><span>Color Mix Pad (X=Point Hue / Y=Mesh Hue)</span></div>
                <div id="live3dColorPad" class="depth-pad live-fx-pad">
                  <div id="live3dColorPadDot" class="depth-pad-dot"></div>
                </div>
                <div class="subgroup-title">3D Background Controls</div>
                <label class="inline-select">
                  <span>Background Type</span>
                  <select id="live3dBgMode">
                    <option value="black">Black</option>
                    <option value="solid">Solid</option>
                    <option value="gradient-linear">Gradient Linear</option>
                    <option value="gradient-radial">Gradient Radial</option>
                    <option value="animated">Animated</option>
                    <option value="grid">Grid Motion</option>
                    <option value="psychedelic-fractal">Psychedelic Fractal</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Background Palette</span>
                  <select id="live3dBgPalette">
                    <option value="custom">Custom</option>
                    <option value="cyber">Cyber</option>
                    <option value="sunset">Sunset</option>
                    <option value="ocean">Ocean</option>
                    <option value="toxic">Toxic</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Color A</span>
                  <input type="color" id="live3dBgColorA" value="#0b1026" />
                </label>
                <label class="inline-select">
                  <span>Color B</span>
                  <input type="color" id="live3dBgColorB" value="#30103d" />
                </label>
                <button id="quick3dBtn" class="btn" data-i18n="quick3d">3D Starter</button>
                <button id="quick3dCleanBtn" class="btn" data-i18n="quick3d_clean">3D Clean Front (M)</button>
                <p class="micro-tip">Tip: usa WASD para paneo 3D, arrastra para orbitar, ←/→ para módulo y ↑/↓ para FX.</p>
              </div>
              <div id="livePaneParticles" class="group live-pane" hidden>
                <h2>Particles Essentials</h2>
                <label class="inline-select">
                  <span>Particle Count</span>
                  <select id="liveParticlesCount">
                    <option value="low">Low</option>
                    <option value="med" selected>Med</option>
                    <option value="high">High</option>
                    <option value="ultra">Ultra</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Emitter</span>
                  <select id="liveParticlesEmitter">
                    <option value="grid" selected>Grid</option>
                    <option value="volume">Volume</option>
                    <option value="motion">Motion</option>
                  </select>
                </label>
                <label class="slider"><span>Size</span><input type="range" id="liveParticlesSize" min="0" max="100" value="42" /><output for="liveParticlesSize">42</output></label>
                <label class="slider"><span>Depth / Z</span><input type="range" id="liveParticlesDepth" min="0" max="100" value="58" /><output for="liveParticlesDepth">58</output></label>
                <label class="slider"><span>Noise</span><input type="range" id="liveParticlesNoise" min="0" max="100" value="0" /><output for="liveParticlesNoise">0</output></label>
                <label class="slider"><span>Attractor</span><input type="range" id="liveParticlesAttractor" min="0" max="100" value="26" /><output for="liveParticlesAttractor">26</output></label>
                <label class="slider"><span>Flow</span><input type="range" id="liveParticlesFlow" min="0" max="100" value="0" /><output for="liveParticlesFlow">0</output></label>
                <label class="inline-select">
                  <span>Camera Mode</span>
                  <select id="liveParticlesCamMode">
                    <option value="static" selected>Static</option>
                    <option value="orbit">Orbit</option>
                    <option value="sweep">Sweep</option>
                    <option value="helix">Helix</option>
                    <option value="inside">Inside</option>
                  </select>
                </label>
                <label class="slider"><span>Camera Anim Speed</span><input type="range" id="liveParticlesCamSpeed" min="0" max="100" value="0" /><output for="liveParticlesCamSpeed">0</output></label>
                <label class="slider"><span>Camera X</span><input type="range" id="liveParticlesCamX" min="-90" max="90" value="0" /><output for="liveParticlesCamX">0</output></label>
                <label class="slider"><span>Camera Y</span><input type="range" id="liveParticlesCamY" min="-180" max="180" value="0" /><output for="liveParticlesCamY">0</output></label>
                <label class="slider"><span>Camera Z</span><input type="range" id="liveParticlesCamZ" min="-180" max="180" value="0" /><output for="liveParticlesCamZ">0</output></label>
                <label class="inline-select">
                  <span>Color Mode</span>
                  <select id="liveParticlesColorMode">
                    <option value="source" selected>From Source</option>
                    <option value="palette">Palette</option>
                    <option value="audio">Audio Heatmap</option>
                  </select>
                </label>
                <label class="slider"><span>Hue Shift</span><input type="range" id="liveParticlesHue" min="0" max="360" value="0" /><output for="liveParticlesHue">0</output></label>
                <label class="toggle"><input type="checkbox" id="liveParticlesAudio" /><span>Audio React</span></label>
                <label class="slider"><span>Audio Amount</span><input type="range" id="liveParticlesAudioAmount" min="0" max="100" value="54" /><output for="liveParticlesAudioAmount">54</output></label>
                <label class="toggle"><input type="checkbox" id="liveParticlesFaceTrack" checked /><span>Face Trace</span></label>
                <label class="slider"><span>Face Delay</span><input type="range" id="liveParticlesFaceDelay" min="0" max="100" value="24" /><output for="liveParticlesFaceDelay">24</output></label>
                <label class="slider"><span>Face Amount</span><input type="range" id="liveParticlesFaceAmount" min="0" max="100" value="68" /><output for="liveParticlesFaceAmount">68</output></label>
                <label class="slider"><span>Light Trail</span><input type="range" id="liveParticlesTrail" min="0" max="100" value="0" /><output for="liveParticlesTrail">0</output></label>
                <label class="inline-select">
                  <span>Structure</span>
                  <select id="liveParticlesStructure">
                    <option value="cloud" selected>Cloud</option>
                    <option value="grid">Grid</option>
                    <option value="ring">Ring</option>
                    <option value="helix">Helix</option>
                    <option value="mandala">Mandala</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Audio Split</span>
                  <select id="liveParticlesAudioSplit">
                    <option value="off">Off</option>
                    <option value="basic" selected>Basic</option>
                    <option value="zones">Zones</option>
                  </select>
                </label>
                <label class="slider"><span>Order</span><input type="range" id="liveParticlesOrder" min="0" max="100" value="48" /><output for="liveParticlesOrder">48</output></label>
                <details class="advanced-only">
                  <summary>Advanced Particles</summary>
                  <label class="slider"><span>Damping</span><input type="range" id="liveParticlesDamping" min="0" max="100" value="18" /><output for="liveParticlesDamping">18</output></label>
                  <label class="slider"><span>Vortex</span><input type="range" id="liveParticlesVortex" min="0" max="100" value="22" /><output for="liveParticlesVortex">22</output></label>
                  <label class="slider"><span>Spawn Rate</span><input type="range" id="liveParticlesSpawn" min="0" max="100" value="68" /><output for="liveParticlesSpawn">68</output></label>
                  <label class="slider"><span>Motion Threshold</span><input type="range" id="liveParticlesMotionThreshold" min="0" max="100" value="32" /><output for="liveParticlesMotionThreshold">32</output></label>
                  <label class="slider"><span>Drift</span><input type="range" id="liveParticlesDrift" min="0" max="100" value="0" /><output for="liveParticlesDrift">0</output></label>
                  <label class="slider"><span>Focal Points</span><input type="range" id="liveParticlesFocus" min="0" max="100" value="38" /><output for="liveParticlesFocus">38</output></label>
                  <label class="inline-select">
                    <span>Gradient Mode</span>
                    <select id="liveParticlesGradientMode">
                      <option value="radial" selected>Radial</option>
                      <option value="axis-x">Axis X</option>
                      <option value="axis-y">Axis Y</option>
                      <option value="spiral">Spiral</option>
                    </select>
                  </label>
                  <label class="slider"><span>Color Mix</span><input type="range" id="liveParticlesColorMix" min="0" max="100" value="44" /><output for="liveParticlesColorMix">44</output></label>
                  <label class="slider"><span>Gradient Spread</span><input type="range" id="liveParticlesGradientSpread" min="0" max="100" value="52" /><output for="liveParticlesGradientSpread">52</output></label>
                  <label class="inline-select">
                    <span>Gradient A</span>
                    <input type="color" id="liveParticlesGradientA" value="#00d8ff" />
                  </label>
                  <label class="inline-select">
                    <span>Gradient B</span>
                    <input type="color" id="liveParticlesGradientB" value="#ff2ea6" />
                  </label>
                </details>
                <div class="subgroup-title">Particles Background Controls</div>
                <label class="inline-select">
                  <span>Background Type</span>
                  <select id="liveParticlesBgMode">
                    <option value="black">Black</option>
                    <option value="solid">Solid</option>
                    <option value="gradient-linear">Gradient Linear</option>
                    <option value="gradient-radial">Gradient Radial</option>
                    <option value="animated">Animated</option>
                    <option value="grid">Grid Motion</option>
                    <option value="psychedelic-fractal">Psychedelic Fractal</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Background Palette</span>
                  <select id="liveParticlesBgPalette">
                    <option value="custom">Custom</option>
                    <option value="cyber">Cyber</option>
                    <option value="sunset">Sunset</option>
                    <option value="ocean">Ocean</option>
                    <option value="toxic">Toxic</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Color A</span>
                  <input type="color" id="liveParticlesBgColorA" value="#0b1026" />
                </label>
                <label class="inline-select">
                  <span>Color B</span>
                  <input type="color" id="liveParticlesBgColorB" value="#30103d" />
                </label>
                <p class="micro-tip">Tip: módulo independiente con partículas XYZ audio-reactivas y auto performance.</p>
              </div>
              <div id="livePaneLines" class="group live-pane" hidden>
                <h2>Lines Essentials</h2>
                <label class="inline-select">
                  <span>Lines Preset</span>
                  <select id="liveLinesPreset">
                    <option value="ambient" selected>Ambient Flow</option>
                    <option value="techno">Techno Grid</option>
                    <option value="vocal">Vocal Contour</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Lines Style</span>
                  <select id="liveLinesStyle" disabled>
                    <option value="minimal" selected>Minimal</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Pattern</span>
                  <select id="liveLinesPattern" disabled>
                    <option value="flow" selected>Flow</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Geometry Mode</span>
                  <select id="liveLinesGeometry">
                    <option value="ribbon" selected>Ribbon Flow</option>
                    <option value="grid">Grid Warp</option>
                    <option value="constellation">Constellation</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Lines Camera</span>
                  <select id="liveLinesCameraMode">
                    <option value="orbit" selected>Orbit</option>
                    <option value="inside">Fly Inside</option>
                    <option value="static">Static</option>
                  </select>
                </label>
                <label class="toggle"><input type="checkbox" id="liveLinesBeatFlip" checked /><span>Beat Flip</span></label>
                <label class="slider"><span>Performance Macro</span><input type="range" id="liveLinesMacro" min="0" max="100" value="42" /><output for="liveLinesMacro">42</output></label>
                <label class="slider"><span>Line Density</span><input type="range" id="liveLinesDensity" min="6" max="30" value="12" /><output for="liveLinesDensity">12</output></label>
                <label class="slider"><span>Line Thickness</span><input type="range" id="liveLinesThickness" min="1" max="24" value="5" /><output for="liveLinesThickness">5</output></label>
                <label class="slider"><span>Curvature</span><input type="range" id="liveLinesCurvature" min="0" max="100" value="34" /><output for="liveLinesCurvature">34</output></label>
                <label class="slider"><span>Depth Z</span><input type="range" id="liveLinesDepth" min="0" max="100" value="54" /><output for="liveLinesDepth">54</output></label>
                <label class="slider"><span>Layer Offset</span><input type="range" id="liveLinesLayerOffset" min="0" max="100" value="48" /><output for="liveLinesLayerOffset">48</output></label>
                <label class="slider"><span>Color Shift</span><input type="range" id="liveLinesColorShift" min="0" max="360" value="120" /><output for="liveLinesColorShift">120</output></label>
                <label class="slider"><span>Flow Speed</span><input type="range" id="liveLinesSpeed" min="0" max="100" value="42" /><output for="liveLinesSpeed">42</output></label>
                <label class="slider"><span>Camera Drift</span><input type="range" id="liveLinesCamDrift" min="0" max="100" value="28" /><output for="liveLinesCamDrift">28</output></label>
                <label class="slider"><span>Inside Depth</span><input type="range" id="liveLinesInsideDepth" min="0" max="100" value="62" /><output for="liveLinesInsideDepth">62</output></label>
                <label class="slider"><span>String Vibe Sensitivity</span><input type="range" id="liveLinesStringVibe" min="0" max="200" value="58" /><output for="liveLinesStringVibe">58</output></label>
                <label class="slider"><span>Constellation Mix</span><input type="range" id="liveLinesConstellation" min="0" max="100" value="32" /><output for="liveLinesConstellation">32</output></label>
                <p class="micro-tip">Tip: arrastra el canvas para mover cámara 3D y usa rueda/trackpad para zoom fluido.</p>
              </div>
              <div id="livePaneTunnel" class="group live-pane" hidden>
                <h2>Tunnel Essentials</h2>
                <label class="inline-select">
                  <span>Tunnel Preset</span>
                  <select id="liveTunnelPreset">
                    <option value="deep" selected>Deep Mesh</option>
                    <option value="pulse">Pulse Points</option>
                    <option value="vortex">Vortex Spiral</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Tunnel Camera</span>
                  <select id="liveTunnelCameraMode">
                    <option value="orbit" selected>Orbit</option>
                    <option value="inside">Inside Fly</option>
                    <option value="sweep">Sweep</option>
                    <option value="static">Static</option>
                  </select>
                </label>
                <label class="toggle"><input type="checkbox" id="liveTunnelAudio" checked /><span>Audio Reactive</span></label>
                <label class="slider"><span>Tunnel Density</span><input type="range" id="liveTunnelDensity" min="8" max="44" value="22" /><output for="liveTunnelDensity">22</output></label>
                <label class="slider"><span>Tunnel Depth</span><input type="range" id="liveTunnelDepth" min="20" max="100" value="74" /><output for="liveTunnelDepth">74</output></label>
                <label class="slider"><span>Tunnel Speed</span><input type="range" id="liveTunnelSpeed" min="0" max="100" value="42" /><output for="liveTunnelSpeed">42</output></label>
                <label class="slider"><span>Tunnel Twist</span><input type="range" id="liveTunnelTwist" min="0" max="100" value="36" /><output for="liveTunnelTwist">36</output></label>
                <label class="slider"><span>Mesh Amount</span><input type="range" id="liveTunnelMesh" min="0" max="100" value="78" /><output for="liveTunnelMesh">78</output></label>
                <label class="slider"><span>Points Amount</span><input type="range" id="liveTunnelPoints" min="0" max="100" value="68" /><output for="liveTunnelPoints">68</output></label>
                <label class="slider"><span>Glow</span><input type="range" id="liveTunnelGlow" min="0" max="100" value="38" /><output for="liveTunnelGlow">38</output></label>
                <label class="slider"><span>Audio Amount</span><input type="range" id="liveTunnelAudioAmount" min="0" max="100" value="70" /><output for="liveTunnelAudioAmount">70</output></label>
                <p class="micro-tip">Tip: O = morph del tunel, T/Y = camara rapida/suave.</p>
              </div>
              <div id="livePaneInterior" class="group live-pane" hidden>
                <h2>Interior Black Essentials</h2>
                <label class="inline-select">
                  <span>Interior Preset</span>
                  <select id="liveInteriorPreset">
                    <option value="abyss" selected>Abyss Chamber</option>
                    <option value="pulse">Pulse Corridor</option>
                    <option value="ruin">Digital Ruin</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Interior Camera</span>
                  <select id="liveInteriorCameraMode">
                    <option value="orbit" selected>Orbit</option>
                    <option value="dive">Dive</option>
                    <option value="static">Static</option>
                  </select>
                </label>
                <label class="toggle"><input type="checkbox" id="liveInteriorAudio" checked /><span>Audio Reactive</span></label>
                <label class="slider"><span>Corridor Density</span><input type="range" id="liveInteriorDensity" min="8" max="48" value="22" /><output for="liveInteriorDensity">22</output></label>
                <label class="slider"><span>Corridor Depth</span><input type="range" id="liveInteriorDepth" min="20" max="100" value="78" /><output for="liveInteriorDepth">78</output></label>
                <label class="slider"><span>Drift Speed</span><input type="range" id="liveInteriorSpeed" min="0" max="100" value="34" /><output for="liveInteriorSpeed">34</output></label>
                <label class="slider"><span>Wave Amount</span><input type="range" id="liveInteriorWave" min="0" max="100" value="56" /><output for="liveInteriorWave">56</output></label>
                <label class="slider"><span>Glitch Amount</span><input type="range" id="liveInteriorGlitch" min="0" max="100" value="42" /><output for="liveInteriorGlitch">42</output></label>
                <label class="slider"><span>Glow</span><input type="range" id="liveInteriorGlow" min="0" max="100" value="44" /><output for="liveInteriorGlow">44</output></label>
                <label class="slider"><span>Audio Amount</span><input type="range" id="liveInteriorAudioAmount" min="0" max="100" value="68" /><output for="liveInteriorAudioAmount">68</output></label>
                <p class="micro-tip">Tip: O = morph interior, T/Y = camara rapida/suave.</p>
              </div>
              <div id="liveOutputGroup" class="group">
                <h2>Output View</h2>
                <label class="inline-select">
                  <span>Output View</span>
                  <select id="liveOutputView">
                    <option value="normal">Normal</option>
                    <option value="dome">Dome</option>
                  </select>
                </label>
                <details class="advanced-only" open>
                  <summary id="liveDomeSummary">Dome Master (All Filters)</summary>
                  <label class="inline-select">
                    <span>Dome Preset</span>
                    <select id="domePreset">
                      <option value="custom" selected>Custom</option>
                      <option value="live-safe">Live Safe</option>
                      <option value="glitch">Glitch</option>
                      <option value="depth">3D Live</option>
                      <option value="particles">Particles</option>
                      <option value="fractal">Fractal</option>
                      <option value="equirect180">360 -> 180 Dome</option>
                    </select>
                  </label>
                  <label class="toggle"><input type="checkbox" id="domeAutoTuneByMode" checked /><span>Auto Tune by module</span></label>
                  <label class="inline-select">
                    <span>Dome Source Map</span>
                    <select id="domeSourceMap">
                      <option value="standard">Standard Warp</option>
                      <option value="equirect">360 Equirect -> 180 Dome</option>
                    </select>
                  </label>
                  <label class="inline-select">
                    <span>Dome Projection</span>
                    <select id="domeProjection">
                      <option value="equisolid" selected>Equisolid (Fulldome)</option>
                      <option value="equidistant">Equidistant</option>
                      <option value="stereographic">Stereographic</option>
                      <option value="orthographic">Orthographic</option>
                    </select>
                  </label>
                  <label class="slider"><span>Dome Warp</span><input type="range" id="domeWarp" min="0" max="100" value="70" /><output for="domeWarp">70</output></label>
                  <label class="slider"><span>Dome Overscan</span><input type="range" id="domeOverscan" min="0" max="20" value="6" /><output for="domeOverscan">6</output></label>
                  <label class="slider"><span>Dome Edge Feather</span><input type="range" id="domeEdgeFeather" min="0" max="100" value="18" /><output for="domeEdgeFeather">18</output></label>
                  <label class="slider"><span>Dome Rim Clamp</span><input type="range" id="domeRimClamp" min="0" max="100" value="28" /><output for="domeRimClamp">28</output></label>
                  <label class="slider"><span>Dome Seam Blend</span><input type="range" id="domeSeamBlend" min="0" max="100" value="22" /><output for="domeSeamBlend">22</output></label>
                  <label class="slider"><span>Dome Tilt</span><input type="range" id="domeTilt" min="-100" max="100" value="0" /><output for="domeTilt">0</output></label>
                  <label class="slider"><span>Dome Rotation</span><input type="range" id="domeRotate" min="-180" max="180" value="0" /><output for="domeRotate">0</output></label>
                  <label class="toggle"><input type="checkbox" id="domeAutoRotate" /><span>Dome Auto Rotate</span></label>
                  <label class="slider"><span>Dome Auto Speed</span><input type="range" id="domeAutoRotateSpeed" min="-100" max="100" value="18" /><output for="domeAutoRotateSpeed">18</output></label>
                  <label class="slider"><span>Dome Grid Guide</span><input type="range" id="domeGrid" min="0" max="100" value="0" /><output for="domeGrid">0</output></label>
                </details>
              </div>
              <div class="group">
                <h2 data-i18n="modulation">Modulation</h2>
                <label class="inline-select">
                  <span data-i18n="mod_source">Source</span>
                  <select id="modSource">
                    <option value="none">None</option>
                    <option value="rms">RMS</option>
                    <option value="band1">Band 1 (Sub)</option>
                    <option value="band2">Band 2 (Bass)</option>
                    <option value="band3">Band 3 (Mid)</option>
                    <option value="band4">Band 4 (High)</option>
                    <option value="transient">Transient</option>
                    <option value="lfo">LFO</option>
                    <option value="manual">Manual</option>
                    <option value="visual_luma">Visual Luma</option>
                    <option value="visual_motion">Visual Motion</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="mod_target">Target</span>
                  <select id="modTarget"></select>
                </label>
                <label class="slider"><span data-i18n="mod_amount">Amount</span><input type="range" id="modAmount" min="-100" max="100" value="0" /><output for="modAmount">0</output></label>
                <label class="inline-select">
                  <span>Curve</span>
                  <select id="modCurve">
                    <option value="smooth">Smooth</option>
                    <option value="linear">Linear</option>
                    <option value="punch">Punch</option>
                    <option value="step">Step</option>
                  </select>
                </label>
                <div id="liveModPadLabel" class="pad-label">Mod Pad (X=Amount / Y=Smoothing)</div>
                <div id="liveModPad" class="depth-pad live-mod-pad">
                  <div id="liveModPadDot" class="depth-pad-dot"></div>
                </div>
                <details class="advanced-only">
                  <summary>Advanced Modulation</summary>
                  <label class="slider"><span data-i18n="mod_smoothing">Smoothing</span><input type="range" id="modSmoothing" min="0" max="100" value="60" /><output for="modSmoothing">60</output></label>
                  <label class="slider"><span data-i18n="mod_clamp">Clamp</span><input type="range" id="modClamp" min="0" max="100" value="100" /><output for="modClamp">100</output></label>
                </details>
                <p class="status-line" id="performanceStatus">FPS: --</p>
                <p class="status-line" id="performanceHint">Auto performance: OFF</p>
                <p class="status-line" id="moduleLoadStatus">Carga módulo: LOW</p>
              </div>
              <p class="status" data-i18n="status_realtime">Realtime ON. Clean mode = original image.</p>
            </section>

            <section class="workspace-panel" id="panelStudio" hidden>
              <h2 class="panel-title" data-i18n="studio_title">Advanced Studio</h2>
              <div class="studio-mode-tabs">
                <button id="studioModeGlitchBtn" class="btn studio-mode-btn active" data-i18n="studio_glitch">Glitch Studio</button>
                <button id="studioModeFractalBtn" class="btn studio-mode-btn" data-i18n="studio_fractal">Fractal Studio</button>
                <button id="studioMode3dBtn" class="btn studio-mode-btn" data-i18n="studio_3d">3D Studio</button>
                <button id="studioModeParticlesBtn" class="btn studio-mode-btn" data-i18n="studio_particles">Particles Studio</button>
              </div>
              <div class="group mode-group" data-modes="glitch" data-studio-group="glitch" hidden>
                <h2>Glitch Rack</h2>
                <label class="slider"><span>RGB Shift</span><input type="range" id="rgbShift" min="0" max="60" value="0" /><output for="rgbShift">0</output></label>
                <label class="slider"><span>Line Jitter</span><input type="range" id="lineJitter" min="0" max="70" value="0" /><output for="lineJitter">0</output></label>
                <label class="slider"><span>Noise</span><input type="range" id="noiseAmount" min="0" max="140" value="0" /><output for="noiseAmount">0</output></label>
                <label class="slider"><span>Salt & Pepper</span><input type="range" id="saltPepper" min="0" max="100" value="0" /><output for="saltPepper">0</output></label>
                <label class="slider"><span>Pixelate</span><input type="range" id="pixelSize" min="1" max="30" value="1" /><output for="pixelSize">1</output></label>
                <label class="slider"><span>Wave Distort</span><input type="range" id="waveDistort" min="0" max="80" value="0" /><output for="waveDistort">0</output></label>
                <label class="slider"><span>Block Shift</span><input type="range" id="blockShift" min="0" max="100" value="0" /><output for="blockShift">0</output></label>
                <label class="slider"><span>Data Bands</span><input type="range" id="dataBands" min="0" max="100" value="0" /><output for="dataBands">0</output></label>
                <label class="slider"><span>Byte Corrupt</span><input type="range" id="byteCorrupt" min="0" max="100" value="0" /><output for="byteCorrupt">0</output></label>
                <label class="slider"><span>Chroma Bleed</span><input type="range" id="chromaBleed" min="0" max="100" value="0" /><output for="chromaBleed">0</output></label>
                <p class="subgroup-title">Pixel Art / Color Blend</p>
                <label class="slider"><span>Pixel Sort</span><input type="range" id="pixelSort" min="0" max="100" value="0" /><output for="pixelSort">0</output></label>
                <label class="slider"><span>Dither Matrix</span><input type="range" id="ditherAmount" min="0" max="100" value="0" /><output for="ditherAmount">0</output></label>
                <label class="slider"><span>Neon Blend</span><input type="range" id="colorBlend" min="0" max="100" value="0" /><output for="colorBlend">0</output></label>
                <label class="slider"><span>Pixel Melt</span><input type="range" id="pixelMelt" min="0" max="100" value="0" /><output for="pixelMelt">0</output></label>
                <p class="subgroup-title">Subject Mask Glitch</p>
                <label class="slider"><span>Mask Ghost</span><input type="range" id="subjectGhost" min="0" max="100" value="0" /><output for="subjectGhost">0</output></label>
                <label class="slider"><span>Ghost Copies</span><input type="range" id="ghostCopies" min="1" max="6" value="1" /><output for="ghostCopies">1</output></label>
                <label class="slider"><span>Ghost Shift</span><input type="range" id="ghostShift" min="0" max="180" value="0" /><output for="ghostShift">0</output></label>
                <label class="slider"><span>Polygon Tracking</span><input type="range" id="polygonTrack" min="0" max="100" value="0" /><output for="polygonTrack">0</output></label>
                <p class="subgroup-title">Color / Finish</p>
                <label class="slider"><span>Scanlines</span><input type="range" id="scanlineIntensity" min="0" max="100" value="0" /><output for="scanlineIntensity">0</output></label>
                <label class="slider"><span>Bloom</span><input type="range" id="bloom" min="0" max="90" value="0" /><output for="bloom">0</output></label>
                <label class="slider"><span>Posterize</span><input type="range" id="posterize" min="2" max="40" value="40" /><output for="posterize">40</output></label>
                <label class="slider"><span>Hue Shift</span><input type="range" id="hueShift" min="-180" max="180" value="0" /><output for="hueShift">0</output></label>
                <label class="slider"><span>Saturation</span><input type="range" id="saturation" min="0" max="200" value="100" /><output for="saturation">100</output></label>
                <label class="slider"><span>Contrast</span><input type="range" id="contrast" min="40" max="220" value="100" /><output for="contrast">100</output></label>
                <label class="slider"><span>Invert Blend</span><input type="range" id="invertBlend" min="0" max="100" value="0" /><output for="invertBlend">0</output></label>
                <label class="slider"><span>Solarize</span><input type="range" id="solarize" min="0" max="100" value="0" /><output for="solarize">0</output></label>
                <label class="slider"><span>Motion Trail FX</span><input type="range" id="motionTrail" min="0" max="100" value="0" /><output for="motionTrail">0</output></label>
                <label class="slider"><span>Trail Decay</span><input type="range" id="trailDecay" min="0" max="100" value="68" /><output for="trailDecay">68</output></label>
                <label class="slider"><span>Trail Threshold</span><input type="range" id="trailThreshold" min="0" max="100" value="42" /><output for="trailThreshold">42</output></label>
                <label class="slider"><span>Trail Softness</span><input type="range" id="trailSoftness" min="0" max="100" value="40" /><output for="trailSoftness">40</output></label>
                <label class="slider"><span>Motion Only</span><input type="range" id="trailMotionOnly" min="0" max="100" value="80" /><output for="trailMotionOnly">80</output></label>
                <label class="slider"><span>Animated Distortion</span><input type="range" id="animDistort" min="0" max="100" value="0" /><output for="animDistort">0</output></label>
                <label class="slider"><span>Anim Speed</span><input type="range" id="animSpeed" min="0" max="100" value="40" /><output for="animSpeed">40</output></label>
                <label class="slider"><span>Error Complexity</span><input type="range" id="errorComplexity" min="0" max="100" value="0" /><output for="errorComplexity">0</output></label>
                <p class="subgroup-title">Analog Glitch</p>
                <label class="slider"><span>VHS Drift</span><input type="range" id="vhsDrift" min="0" max="100" value="0" /><output for="vhsDrift">0</output></label>
                <label class="slider"><span>Tape Noise</span><input type="range" id="tapeNoise" min="0" max="100" value="0" /><output for="tapeNoise">0</output></label>
                <label class="slider"><span>Head Switch</span><input type="range" id="headSwitch" min="0" max="100" value="0" /><output for="headSwitch">0</output></label>
              </div>

              <div class="group mode-group legacy-fractal" data-modes="fractal,mix" data-studio-group="fractal" hidden>
                <h2>Fractal Rack</h2>
                <label class="inline-select">
                  <span>Pattern</span>
                  <select id="fractalPattern">
                    <option value="kaleido">Kaleido Mirror</option>
                    <option value="spiral">Spiral</option>
                    <option value="mandala">Mandala</option>
                    <option value="hybrid">Hybrid</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Fractal Source</span>
                  <select id="fractalSource">
                    <option value="original">Original Image</option>
                    <option value="glitch">Glitch Base Image</option>
                  </select>
                </label>
                <label class="slider"><span>Segments (mirror)</span><input type="range" id="kaleidoSegments" min="1" max="24" value="1" /><output for="kaleidoSegments">1</output></label>
                <label class="slider"><span>Layers</span><input type="range" id="kaleidoLayers" min="1" max="8" value="1" /><output for="kaleidoLayers">1</output></label>
                <label class="slider"><span>Layer Echo</span><input type="range" id="layerEcho" min="0" max="100" value="0" /><output for="layerEcho">0</output></label>
                <label class="slider"><span>Twist</span><input type="range" id="kaleidoTwist" min="0" max="100" value="0" /><output for="kaleidoTwist">0</output></label>
                <label class="slider"><span>Fractal Zoom</span><input type="range" id="fractalZoom" min="40" max="260" value="100" /><output for="fractalZoom">100</output></label>
                <label class="slider"><span>Fractal Pulse</span><input type="range" id="fractalPulse" min="0" max="100" value="0" /><output for="fractalPulse">0</output></label>
                <p class="subgroup-title">Spiral / Mandala</p>
                <label class="slider"><span>Spiral Amount</span><input type="range" id="spiralAmount" min="0" max="100" value="0" /><output for="spiralAmount">0</output></label>
                <label class="slider"><span>Spiral Turns</span><input type="range" id="spiralTurns" min="1" max="28" value="8" /><output for="spiralTurns">8</output></label>
                <label class="slider"><span>Mandala Petals</span><input type="range" id="mandalaPetals" min="2" max="28" value="8" /><output for="mandalaPetals">8</output></label>
                <label class="slider"><span>Mandala Bloom</span><input type="range" id="mandalaBloom" min="0" max="100" value="0" /><output for="mandalaBloom">0</output></label>
                <p class="subgroup-title">Psychedelic Color</p>
                <label class="slider"><span>Psychedelic</span><input type="range" id="psychedelic" min="0" max="100" value="0" /><output for="psychedelic">0</output></label>
                <label class="slider"><span>Color Cycle</span><input type="range" id="colorCycle" min="0" max="360" value="0" /><output for="colorCycle">0</output></label>
                <div class="pad-label" id="studioFractalPadALabel">FRA A Pad (X=Symmetry / Y=Power)</div>
                <div id="studioFractalPadA" class="depth-pad">
                  <div id="studioFractalPadADot" class="depth-pad-dot"></div>
                </div>
                <div class="pad-label" id="studioFractalPadBLabel">FRA B Pad (X=Glow / Y=Optical)</div>
                <div id="studioFractalPadB" class="depth-pad">
                  <div id="studioFractalPadBDot" class="depth-pad-dot"></div>
                </div>
              </div>

              <div class="group mode-group" id="depthControlsGroup" data-modes="depth" data-studio-group="depth" hidden>
                <h2>3D Stage</h2>
                <p class="micro-tip">Tip: empieza con "3D Starter" y mueve el mouse en el viewport.</p>
                <p class="subgroup-title">3D Geometry / Motion</p>
                <label class="slider"><span>Depth Strength</span><input type="range" id="depthStrength" min="0" max="100" value="0" /><output for="depthStrength">0</output></label>
                <label class="slider"><span>Point Map</span><input type="range" id="pointMap" min="0" max="100" value="0" /><output for="pointMap">0</output></label>
                <label class="slider"><span>Point Density</span><input type="range" id="pointDensity" min="6" max="40" value="20" /><output for="pointDensity">20</output></label>
                <label class="slider"><span>Point Size</span><input type="range" id="pointSize" min="1" max="10" value="2" /><output for="pointSize">2</output></label>
                <label class="slider"><span>Point Float</span><input type="range" id="pointFloat" min="0" max="100" value="0" /><output for="pointFloat">0</output></label>
                <label class="slider"><span>Organic Interaction</span><input type="range" id="pointOrganic" min="0" max="100" value="0" /><output for="pointOrganic">0</output></label>
                <label class="slider"><span>Point Lift Z</span><input type="range" id="pointLift" min="0" max="100" value="0" /><output for="pointLift">0</output></label>
                <label class="slider"><span>Mesh Map</span><input type="range" id="meshMap" min="0" max="100" value="0" /><output for="meshMap">0</output></label>
                <label class="slider"><span>Mesh Density</span><input type="range" id="meshDensity" min="12" max="90" value="34" /><output for="meshDensity">34</output></label>
                <label class="slider"><span>Mesh Lift Z</span><input type="range" id="meshLift" min="0" max="100" value="0" /><output for="meshLift">0</output></label>
                <label class="slider"><span>Point Color Shift</span><input type="range" id="pointColorShift" min="0" max="360" value="0" /><output for="pointColorShift">0</output></label>
                <label class="slider"><span>Mesh Color Shift</span><input type="range" id="meshColorShift" min="0" max="360" value="0" /><output for="meshColorShift">0</output></label>
                <label class="slider"><span>Mesh Glow</span><input type="range" id="meshGlow" min="0" max="100" value="0" /><output for="meshGlow">0</output></label>
                <label class="slider"><span>Ambient</span><input type="range" id="ambientLight" min="0" max="100" value="35" /><output for="ambientLight">35</output></label>
                <label class="slider"><span>Light Power</span><input type="range" id="lightIntensity" min="0" max="180" value="80" /><output for="lightIntensity">80</output></label>
                <label class="slider"><span>Exposure</span><input type="range" id="sceneExposure" min="40" max="220" value="110" /><output for="sceneExposure">110</output></label>
                <label class="slider"><span>Depth Exaggeration</span><input type="range" id="depthExaggeration" min="40" max="320" value="100" /><output for="depthExaggeration">100</output></label>
                <label class="slider"><span>Point Spread</span><input type="range" id="pointSpread" min="0" max="200" value="0" /><output for="pointSpread">0</output></label>
                <div class="pad-label">3D Pad (Rotate + Lift)</div>
                <div id="depthPad" class="depth-pad">
                  <div id="depthPadDot" class="depth-pad-dot"></div>
                </div>

                <details class="advanced-only" open>
                  <summary>Advanced 3D</summary>
                  <label class="slider"><span>Depth Shift</span><input type="range" id="depthShift" min="0" max="80" value="0" /><output for="depthShift">0</output></label>
                  <label class="slider"><span>Depth View</span><input type="range" id="depthView" min="0" max="100" value="0" /><output for="depthView">0</output></label>
                  <label class="slider"><span>Rotate X</span><input type="range" id="pointRotateX" min="-90" max="90" value="0" /><output for="pointRotateX">0</output></label>
                  <label class="slider"><span>Rotate Y</span><input type="range" id="pointRotateY" min="-90" max="90" value="0" /><output for="pointRotateY">0</output></label>
                  <label class="slider"><span>Rotate Z</span><input type="range" id="pointRotateZ" min="-180" max="180" value="0" /><output for="pointRotateZ">0</output></label>
                  <label class="slider"><span>3D Glitch Jitter</span><input type="range" id="glitch3d" min="0" max="100" value="0" /><output for="glitch3d">0</output></label>
                  <h3>Lighting</h3>
                <label class="slider"><span>Lighting Enable</span><input type="range" id="lightEnabled" min="0" max="100" value="100" /><output for="lightEnabled">100</output></label>
                <label class="slider"><span>Flat Illustrated</span><input type="range" id="flatIllustrated" min="0" max="100" value="0" /><output for="flatIllustrated">0</output></label>
                <label class="slider"><span>Light Azimuth</span><input type="range" id="lightAzimuth" min="-180" max="180" value="-40" /><output for="lightAzimuth">-40</output></label>
                <label class="slider"><span>Light Elevation</span><input type="range" id="lightElevation" min="-80" max="80" value="30" /><output for="lightElevation">30</output></label>
                <label class="slider"><span>Camera Zoom</span><input type="range" id="cameraZoom" min="40" max="180" value="100" /><output for="cameraZoom">100</output></label>
                <label class="slider"><span>Cursor Camera</span><input type="range" id="cameraFollow" min="0" max="100" value="35" /><output for="cameraFollow">35</output></label>
                <label class="slider"><span>Auto Rotate</span><input type="range" id="autoRotate" min="0" max="100" value="0" /><output for="autoRotate">0</output></label>
                <p class="subgroup-title">Aesthetic / Light FX</p>
                <label class="slider"><span>Point Color Pulse</span><input type="range" id="pointColorPulse" min="0" max="100" value="0" /><output for="pointColorPulse">0</output></label>
                <label class="slider"><span>Depth Color Wave</span><input type="range" id="depthColorWave" min="0" max="100" value="0" /><output for="depthColorWave">0</output></label>
                <p class="subgroup-title">3D Background</p>
                <label class="inline-select">
                  <span>Background Mode</span>
                  <select id="bgMode">
                    <option value="black">Black</option>
                    <option value="solid">Solid</option>
                    <option value="gradient-linear">Gradient Linear</option>
                    <option value="gradient-radial">Gradient Radial</option>
                    <option value="animated">Animated</option>
                    <option value="grid">Grid Motion</option>
                    <option value="psychedelic-fractal">Psychedelic Fractal</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Background Palette</span>
                  <select id="bgPalette">
                    <option value="custom">Custom</option>
                    <option value="cyber">Cyber</option>
                    <option value="sunset">Sunset</option>
                    <option value="ocean">Ocean</option>
                    <option value="toxic">Toxic</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Background Color A</span>
                  <input type="color" id="bgColorA" value="#0b1026" />
                </label>
                <label class="inline-select">
                  <span>Background Color B</span>
                  <input type="color" id="bgColorB" value="#30103d" />
                </label>
                <label class="slider"><span>Background Motion</span><input type="range" id="bgMotion" min="0" max="100" value="35" /><output for="bgMotion">35</output></label>
                </details>
              </div>

              <div class="group mode-group" id="particlesControlsGroup" data-modes="particles" data-studio-group="particles" hidden>
                <h2>Particles Studio</h2>
                <p class="micro-tip">Tip: usa reposo + focos para limpiar la nube, y mezcla de gradiente para color musical.</p>
                <p class="subgroup-title">Estructura / Movimiento</p>
                <label class="inline-select">
                  <span>Estructura</span>
                  <select id="studioParticlesStructure">
                    <option value="cloud">Cloud</option>
                    <option value="grid">Grid</option>
                    <option value="ring">Ring</option>
                    <option value="helix">Helix</option>
                    <option value="mandala">Mandala</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span>Audio Split</span>
                  <select id="studioParticlesAudioSplit">
                    <option value="off">Off</option>
                    <option value="basic">Basic</option>
                    <option value="zones">Zones</option>
                  </select>
                </label>
                <label class="slider"><span>Orden / Forma</span><input type="range" id="studioParticlesOrder" min="0" max="100" value="48" /><output for="studioParticlesOrder">48</output></label>
                <label class="slider"><span>Reposo (menos movimiento)</span><input type="range" id="studioParticlesDrift" min="0" max="100" value="34" /><output for="studioParticlesDrift">34</output></label>
                <label class="slider"><span>Puntos focales</span><input type="range" id="studioParticlesFocus" min="0" max="100" value="38" /><output for="studioParticlesFocus">38</output></label>
                <label class="slider"><span>Damping</span><input type="range" id="studioParticlesDamping" min="0" max="100" value="18" /><output for="studioParticlesDamping">18</output></label>
                <label class="slider"><span>Vórtice</span><input type="range" id="studioParticlesVortex" min="0" max="100" value="22" /><output for="studioParticlesVortex">22</output></label>
                <label class="slider"><span>Spawn Rate</span><input type="range" id="studioParticlesSpawn" min="0" max="100" value="68" /><output for="studioParticlesSpawn">68</output></label>
                <label class="slider"><span>Motion Threshold</span><input type="range" id="studioParticlesMotionThreshold" min="0" max="100" value="32" /><output for="studioParticlesMotionThreshold">32</output></label>
                <p class="subgroup-title">Color / Gradiente</p>
                <label class="inline-select">
                  <span>Modo gradiente</span>
                  <select id="studioParticlesGradientMode">
                    <option value="radial">Radial</option>
                    <option value="axis-x">Axis X</option>
                    <option value="axis-y">Axis Y</option>
                    <option value="spiral">Spiral</option>
                  </select>
                </label>
                <label class="slider"><span>Mezcla color-gradiente</span><input type="range" id="studioParticlesColorMix" min="0" max="100" value="44" /><output for="studioParticlesColorMix">44</output></label>
                <label class="slider"><span>Extensión gradiente</span><input type="range" id="studioParticlesGradientSpread" min="0" max="100" value="52" /><output for="studioParticlesGradientSpread">52</output></label>
                <label class="inline-select">
                  <span>Color gradiente A</span>
                  <input type="color" id="studioParticlesGradientA" value="#00d8ff" />
                </label>
                <label class="inline-select">
                  <span>Color gradiente B</span>
                  <input type="color" id="studioParticlesGradientB" value="#ff2ea6" />
                </label>
              </div>
            </section>
          </aside>

          <section class="right-panel">
            <header class="visual-title" data-i18n="visualization_deck">Visualization Deck</header>
            <div class="canvas-shell">
              <canvas id="canvas" width="1000" height="680"></canvas>
              <div id="canvasEntryOverlay" class="canvas-entry-overlay">
                <div class="canvas-entry-card">
                  <div class="canvas-entry-brand" data-text="B.ZU.AL Studios">
                    <span>B.ZU.AL Studios</span>
                  </div>
                  <div class="canvas-entry-title">Start Input</div>
                  <p class="canvas-entry-sub">Choose an input to begin visual performance</p>
                  <div class="canvas-entry-actions">
                    <button id="canvasOverlayImageBtn" class="btn canvas-entry-btn">
                      <span class="canvas-entry-btn-icon">IMG</span>
                      <span>Image</span>
                    </button>
                    <button id="canvasOverlayWebcamBtn" class="btn canvas-entry-btn">
                      <span class="canvas-entry-btn-icon">CAM</span>
                      <span>Webcam</span>
                    </button>
                    <button id="canvasOverlayNoInputBtn" class="btn canvas-entry-btn">
                      <span class="canvas-entry-btn-icon">N/I</span>
                      <span>No Input</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="canvas-mini-meta" id="canvasMiniMeta">
              <span id="canvasMiniResolution">Canvas 0x0</span>
              <span id="canvasMiniFps">0 FPS</span>
              <span id="canvasMiniLoad" class="perf-load-badge perf-load-low">Load LOW</span>
            </div>
            <div id="moduleRouteHint" class="module-route-hint hidden">
              <div class="module-route-actions module-route-switch">
                <button class="btn module-route-btn" data-module-route="glitch">
                  <span class="live-mode-icon">GL</span><span>Glitch</span>
                </button>
                <button class="btn module-route-btn" data-module-route="fractal">
                  <span class="live-mode-icon">FR</span><span>Fractal</span>
                </button>
                <button class="btn module-route-btn" data-module-route="depth">
                  <span class="live-mode-icon">3D</span><span>3D</span>
                </button>
                <button class="btn module-route-btn" data-module-route="particles">
                  <span class="live-mode-icon">PT</span><span>Particles</span>
                </button>
                <button class="btn module-route-btn" data-module-route="lines">
                  <span class="live-mode-icon">LN</span><span>Lines</span>
                </button>
                <button class="btn module-route-btn" data-module-route="tunnel">
                  <span class="live-mode-icon">TN</span><span>Tunnel</span>
                </button>
                <button class="btn module-route-btn" data-module-route="interior">
                  <span class="live-mode-icon">IR</span><span>Interior</span>
                </button>
              </div>
              <div class="module-route-utility">
                <button id="liveModeRandomBtn" class="btn module-route-random-btn">
                  <span class="live-mode-icon">R</span><span>Random (R)</span>
                </button>
              </div>
            </div>

            <div class="deck-controls" id="cameraDeckControls">
              <label class="inline-select canvas-aspect-control">
                <span data-i18n="aspect_ratio">Aspect Ratio</span>
                <select id="aspectRatioSelect">
                  <option value="auto">Auto</option>
                  <option value="16:9">16:9</option>
                  <option value="4:3">4:3</option>
                  <option value="1:1">1:1</option>
                  <option value="9:16">9:16</option>
                  <option value="21:9" selected>21:9</option>
                </select>
              </label>
              <div class="fx-compact-row">
                <details id="masterFxDetails" class="master-fx-details">
                  <summary>
                    Master FX (Global)
                    <span id="masterFxSummaryStatus" class="master-fx-summary-status">OFF · None</span>
                  </summary>
                  <label class="inline-select">
                    <span>Master FX</span>
                    <select id="masterFxMode">
                      <option value="none">None</option>
                      <option value="chromatic">Chromatic</option>
                      <option value="interlace">Interlace Drift</option>
                      <option value="datamosh">Datamosh Trail</option>
                      <option value="pixelart">Pixel Art</option>
                      <option value="crt">CRT</option>
                      <option value="trail">Trail (Accented)</option>
                      <option value="psychedelic">Psychedelic</option>
                      <option value="psygrad">Psy Gradient</option>
                      <option value="luminous">Luminous Flux</option>
                      <option value="visionpass">Visionary High Pass</option>
                      <option value="neon">Neon Glow</option>
                      <option value="neongrad">Neon Gradient</option>
                    </select>
                  </label>
                  <label class="slider">
                    <span>Master FX Amount</span>
                    <input type="range" id="masterFxAmount" min="0" max="100" value="28" />
                    <output for="masterFxAmount">28</output>
                  </label>
                  <label class="slider">
                    <span>Master FX Speed</span>
                    <input type="range" id="masterFxSpeed" min="0" max="100" value="42" />
                    <output for="masterFxSpeed">42</output>
                  </label>
                  <label class="slider">
                    <span>Master FX Color</span>
                    <input type="range" id="masterFxColor" min="0" max="100" value="52" />
                    <output for="masterFxColor">52</output>
                  </label>
                  <div class="pad-label"><span class="pad-icon">MFX</span><span>Master Pad (X=Amount / Y=Color)</span></div>
                  <div id="masterFxPad" class="depth-pad live-fx-pad">
                    <div id="masterFxPadDot" class="depth-pad-dot"></div>
                  </div>
                </details>
                <details id="kaleidoFxDetails" class="master-fx-details">
                  <summary>
                    Kaleidoscope
                    <span id="kaleidoFxSummaryStatus" class="master-fx-summary-status">OFF · Tunnel</span>
                  </summary>
                  <label class="toggle"><input type="checkbox" id="kaleidoFxEnabled" /><span>Enable Kaleidoscope</span></label>
                  <label class="inline-select">
                    <span>Kaleido Type</span>
                    <select id="kaleidoFxType">
                      <option value="tunnel" selected>Tunnel</option>
                      <option value="mirror">Mirror</option>
                      <option value="radial">Radial</option>
                      <option value="spiral">Spiral</option>
                      <option value="mandala">Mandala</option>
                      <option value="yantra">Yantra Grid</option>
                      <option value="organic">Organic Bloom</option>
                      <option value="petals">Sacred Petals</option>
                      <option value="moire">Moire Flow</option>
                      <option value="lotus">Lotus Bloom</option>
                      <option value="lattice">Sacred Lattice</option>
                    </select>
                  </label>
                  <label class="slider">
                    <span>Kaleido Amount</span>
                    <input type="range" id="kaleidoFxAmount" min="0" max="100" value="38" />
                    <output for="kaleidoFxAmount">38</output>
                  </label>
                  <label class="slider">
                    <span>Kaleido Speed</span>
                    <input type="range" id="kaleidoFxSpeed" min="0" max="100" value="35" />
                    <output for="kaleidoFxSpeed">35</output>
                  </label>
                  <label class="slider">
                    <span>Kaleido Smooth</span>
                    <input type="range" id="kaleidoFxSmooth" min="0" max="100" value="44" />
                    <output for="kaleidoFxSmooth">44</output>
                  </label>
                  <label class="slider">
                    <span>Kaleido Segments</span>
                    <input type="range" id="kaleidoFxSegments" min="4" max="12" value="10" />
                    <output for="kaleidoFxSegments">10</output>
                  </label>
                  <label class="slider">
                    <span>Kaleido Zoom</span>
                    <input type="range" id="kaleidoFxZoom" min="150" max="320" value="200" />
                    <output for="kaleidoFxZoom">200</output>
                  </label>
                  <div class="pad-label"><span class="pad-icon">KAL</span><span>Kaleido Pad (X=Amount / Y=Smooth)</span></div>
                  <div id="kaleidoFxPad" class="depth-pad live-fx-pad">
                    <div id="kaleidoFxPadDot" class="depth-pad-dot"></div>
                  </div>
                </details>
              </div>
              <details id="cameraControlsDetails" class="camera-controls-details">
                <summary data-i18n="camera_controls">Camera Controls</summary>
                <p class="subgroup-title" data-i18n="camera_modes">Camera Modes</p>
                <div class="camera-mode-box">
                  <button id="camStaticBtn" class="btn cam-btn" data-i18n="cam_static">Static</button>
                  <button id="camCursorBtn" class="btn cam-btn" data-i18n="cam_cursor">Cursor</button>
                  <button id="camOrbitBtn" class="btn cam-btn" data-i18n="cam_orbit">Orbit</button>
                  <button id="camSweepBtn" class="btn cam-btn" data-i18n="cam_sweep">Sweep X</button>
                  <button id="camPulseBtn" class="btn cam-btn" data-i18n="cam_pulse">Dolly Pulse</button>
                  <button id="camHelixBtn" class="btn cam-btn" data-i18n="cam_helix">Helix</button>
                  <button id="camDriftBtn" class="btn cam-btn" data-i18n="cam_drift">Drift Glitch</button>
                  <button id="camLiquidBtn" class="btn cam-btn" data-i18n="cam_liquid">Liquid</button>
                </div>
                <label class="slider">
                  <span data-i18n="camera_move_speed">Camera Speed</span>
                  <input type="range" id="cameraMoveSpeed" min="0" max="100" value="28" />
                  <output for="cameraMoveSpeed">28</output>
                </label>
              </details>
            </div>

            <div class="output-zone">
              <p class="subgroup-title" data-i18n="recording">Recording</p>
              <div class="recording-quick">
                <button id="recordStartBtn" class="btn btn-record-main btn-record-compact" title="Record / Pause / Resume">
                  <span id="recordStartIcon" class="action-icon action-icon-rec">REC</span>
                  <span class="action-label" data-i18n="record_short">Rec</span>
                </button>
                <button id="recordSaveBtn" class="btn btn-save-main btn-record-compact" title="Save recording">
                  <span class="action-icon action-icon-save">SAVE</span>
                  <span class="action-label" data-i18n="save_short">Guardar</span>
                </button>
                <div class="rec-indicator" id="recordingIndicator" aria-live="polite">
                  <span class="dot"></span>
                  <span id="recordingStatusText" data-i18n="record_status_idle">IDLE</span>
                </div>
              </div>
              <details class="recording-advanced">
                <summary>Recording Settings</summary>
                <div class="recording-head">
                <label class="inline-select">
                  <span data-i18n="record_source">Record Source</span>
                  <select id="recordSource">
                    <option value="canvas" data-i18n="record_source_canvas">Clean Canvas</option>
                    <option value="screen" data-i18n="record_source_screen">Screen</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="record_quality">Record Quality</span>
                  <select id="recordQuality">
                    <option value="low" data-i18n="record_quality_low">Low</option>
                    <option value="medium" data-i18n="record_quality_medium" selected>Medium</option>
                    <option value="high" data-i18n="record_quality_high">High</option>
                  </select>
                </label>
                <label class="inline-select">
                  <span data-i18n="record_resolution">Record Resolution</span>
                  <select id="recordResolution">
                    <option value="auto" data-i18n="record_resolution_auto" selected>Auto</option>
                    <option value="720">720p</option>
                    <option value="1080">1080p</option>
                    <option value="1440">1440p</option>
                  </select>
                </label>
                </div>
              </details>
              <p class="subgroup-title" data-i18n="exports">Exports</p>
              <div class="output-inline-row">
                <button id="exportPhotoBtn" class="btn btn-photo-main btn-output-compact">
                  <span class="action-icon action-icon-photo">IMG</span>
                  <span class="action-label" data-i18n="export_photo">Photo HQ</span>
                </button>
              </div>
              <p class="subgroup-title" data-i18n="clean_output">Clean Output</p>
              <p class="clean-output-note" data-i18n="clean_output_note">
                LIVE signal, optimized for maximum clean projection quality.
              </p>
              <div class="output-inline-row">
                <button id="openCleanOutputBtn" class="btn btn-output-compact btn-clean-output">
                  <span class="action-icon">OUT</span>
                  <span class="action-label" data-i18n="open_clean_output">Open Clean Output</span>
                </button>
                <button id="closeCleanOutputBtn" class="btn btn-output-compact btn-clean-output">
                  <span class="action-icon">X</span>
                  <span class="action-label" data-i18n="close_clean_output">Close Clean Output</span>
                </button>
              </div>
            </div>

            <video id="webcam" autoplay playsinline muted hidden></video>
            <div class="performance-bar">
              <div class="session-head">
                <span class="session-title" data-i18n="sessions_title">Sesiones</span>
                <span class="session-hint" data-i18n="sessions_hint">Shift+1..8 guardar, 1..8 cargar</span>
              </div>
              <button id="snapshotSaveBtn" class="btn mini" data-i18n="sessions_save">Guardar sesión</button>
              <button id="snapshotLoadBtn" class="btn mini" data-i18n="sessions_load">Cargar sesión</button>
              <button id="snapshotClearBtn" class="btn mini panic" data-i18n="sessions_clear">Borrar slot</button>
              <div class="snapshot-row">
                <button class="btn mini snapshot-slot" data-slot="1">1</button>
                <button class="btn mini snapshot-slot" data-slot="2">2</button>
                <button class="btn mini snapshot-slot" data-slot="3">3</button>
                <button class="btn mini snapshot-slot" data-slot="4">4</button>
                <button class="btn mini snapshot-slot" data-slot="5">5</button>
                <button class="btn mini snapshot-slot" data-slot="6">6</button>
                <button class="btn mini snapshot-slot" data-slot="7">7</button>
                <button class="btn mini snapshot-slot" data-slot="8">8</button>
              </div>
            </div>
            <div class="deck-footer">
              <span data-i18n="footer_mouse">Mouse: 3D tilt + drag orbit</span>
              <span data-i18n="footer_engine">Render Engine 2K</span>
              <span data-i18n="footer_legal_short">Pixel Error Lab 2000 · Creación de B.ZU.AL Estudio</span>
            </div>
          </section>
        </div>
      </section>
    </main>

    <div id="recordNameModal" class="record-name-modal" hidden>
      <div class="record-name-panel">
        <h3 data-i18n="record_name_title">B.ZU.AL Studios</h3>
        <p data-i18n="record_name_subtitle">¿Cómo quieres guardar esta grabación?</p>
        <label class="record-name-label" for="recordNameInput" data-i18n="record_name_label">Nombre del archivo</label>
        <input id="recordNameInput" type="text" maxlength="120" />
        <div class="record-name-actions">
          <button id="recordNameCancelBtn" class="btn mini" data-i18n="record_name_cancel">Cancelar</button>
          <button id="recordNameSaveBtn" class="btn mini" data-i18n="record_name_save">Guardar</button>
        </div>
      </div>
    </div>

    <div id="infoLegalModal" class="record-name-modal" hidden>
      <div class="record-name-panel info-legal-panel">
        <h3 data-i18n="info_title">B.ZU.AL Studios · Info legal</h3>
        <p data-i18n="info_subtitle">Términos y avisos clave para uso de la app en visuales en vivo.</p>
        <div class="info-legal-content">
          <p data-i18n="info_identity"><strong>Identidad del proyecto:</strong> Pixel Error Lab 2000 es creación de B.ZU.AL Estudio (B.ZU.AL Studios).</p>
          <p data-i18n="info_author"><strong>Autoría:</strong> B.ZU.AL Studios. Todos los derechos reservados sobre marca, diseño y código no licenciado explícitamente.</p>
          <p data-i18n="info_use"><strong>Uso:</strong> Permitido para pruebas, rehearsals y shows. No redistribuir ni revender esta versión sin autorización escrita.</p>
          <p data-i18n="info_privacy"><strong>Privacidad:</strong> Cámara/micrófono/audio se procesan localmente en el navegador; no se suben por defecto a servidores de la app.</p>
          <p data-i18n="info_media"><strong>Contenido:</strong> El usuario es responsable de derechos de imagen, audio, video y material importado.</p>
          <p data-i18n="info_health"><strong>Salud visual:</strong> Algunos modos pueden incluir destellos/contraste alto. Úsalo con precaución en personas fotosensibles.</p>
          <p data-i18n="info_thirdparty"><strong>Terceros:</strong> La app puede usar APIs/librerías del navegador y servicios externos de hosting/deploy.</p>
          <p data-i18n="info_version"><strong>Estado:</strong> Versión beta en evolución continua para performance visual en vivo.</p>
        </div>
        <div class="record-name-actions">
          <button id="infoLegalCloseBtn" class="btn mini" data-i18n="info_close">Cerrar</button>
        </div>
      </div>
    </div>

    <div id="learnModal" class="record-name-modal" hidden>
      <div class="record-name-panel info-legal-panel">
        <h3 data-i18n="learn_title">Guía rápida · Shortcuts</h3>
        <p data-i18n="learn_subtitle">Atajos para empezar rápido y jugar en vivo.</p>
        <div class="info-legal-content learn-content">
          <p data-i18n="learn_intro"><strong>Cómo jugar:</strong> Carga imagen/webcam, activa audio reactivo, elige módulo y prueba atajos.</p>
          <ul>
            <li data-i18n="learn_shortcut_r">R: Random del módulo actual (no afecta AudioPad).</li>
            <li data-i18n="learn_shortcut_t">T: Cambio de cámara rápido (salto).</li>
            <li data-i18n="learn_shortcut_y">Y: Cambio de cámara suave (morph).</li>
            <li data-i18n="learn_shortcut_o">O: Morph visual del módulo activo.</li>
            <li data-i18n="learn_shortcut_j">J: Cambiar tipo de Kaleidoscopio.</li>
            <li data-i18n="learn_shortcut_k">K: Activar/Desactivar Kaleidoscopio.</li>
            <li data-i18n="learn_shortcut_arrows_ud">Flechas Arriba/Abajo: Cambiar Master FX.</li>
            <li data-i18n="learn_shortcut_arrows_lr">Flechas Izquierda/Derecha: Cambiar módulo Live.</li>
            <li data-i18n="learn_shortcut_b">B: Baseline Live Safe (estable).</li>
            <li data-i18n="learn_shortcut_space">Espacio: Freeze/Unfreeze.</li>
            <li data-i18n="learn_shortcut_p">P: Panic reset seguro.</li>
            <li data-i18n="learn_shortcut_snap">1-8: Cargar sesión · Shift+1-8: Guardar sesión.</li>
          </ul>
          <p data-i18n="learn_tip"><strong>Tip:</strong> Usa el AudioPad (X sensibilidad, Y tolerancia) para afinar cuánto se mueve con la música.</p>
        </div>
        <div class="record-name-actions">
          <button id="learnCloseBtn" class="btn mini" data-i18n="learn_close">Cerrar</button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
